<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bikash Moktan - Knowledge Base</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/4.3.0/marked.min.js"></script>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            margin: 0;
            padding: 0;
            background-color: #fafafa;
            color: #333;
        }
        header {
            background-color: #2d3e50;
            color: white;
            padding: 3em 0;
            text-align: center;
        }
        header h1 {
            font-size: 2.5em;
            margin: 0;
        }
        section {
            padding: 2em;
            margin: 1em 0;
        }
        h2 {
            font-size: 2em;
            color: #2d3e50;
        }
        .category {
            margin-bottom: 1.5em;
            padding: 1em;
            background-color: #f4f4f4;
            border-radius: 8px;
        }
        .category h3 {
            cursor: pointer;
            color: #2d3e50;
        }
        .markdown-content {
            display: none;
            background: #fff;
            padding: 1em;
            border-radius: 8px;
            border: 1px solid #ddd;
            margin-top: 1em;
        }
        footer {
            background-color: #2d3e50;
            color: white;
            text-align: center;
            padding: 2em 0;
            margin-top: 2em;
        }
    </style>
</head>
<body>

    <header>
        <h1>Bikash Moktan - Knowledge Base</h1>
        <p>Software Developer | Knowledge Base from GitHub</p>
    </header>

    <section id="knowledge-base">
        <h2>Categories</h2>
        <div id="category-list">Loading categories...</div>
    </section>

    <footer>
        <p>© 2025 Bikash Moktan. All rights reserved.</p>
        <p><a href="https://github.com/bikamokt" target="_blank">GitHub</a></p>
    </footer>

    <script>
        const username = "bikamokt";  // Replace with your GitHub username
        const repo = "your-repo-name";  // Replace with your repository name
        const categoryPath = "categories";  // The folder containing categories

        async function fetchCategories() {
            const apiUrl = `https://api.github.com/repos/${username}/${repo}/contents/${categoryPath}`;

            try {
                const response = await fetch(apiUrl);
                const categories = await response.json();
                const categoryList = document.getElementById("category-list");
                categoryList.innerHTML = ""; // Clear default text

                categories.forEach(async (category) => {
                    if (category.type === "dir") { // Check if it's a folder (category)
                        const categoryDiv = document.createElement("div");
                        categoryDiv.classList.add("category");
                        categoryDiv.innerHTML = `<h3 onclick="toggleCategory('${category.name}')">${category.name} ▼</h3><div id="${category.name}-content"></div>`;
                        categoryList.appendChild(categoryDiv);

                        await fetchMarkdownFiles(category.name);
                    }
                });
            } catch (error) {
                console.error("Error fetching categories:", error);
                document.getElementById("category-list").innerHTML = "<p>Failed to load categories.</p>";
            }
        }

        async function fetchMarkdownFiles(categoryName) {
            const apiUrl = `https://api.github.com/repos/${username}/${repo}/contents/${categoryPath}/${categoryName}`;

            try {
                const response = await fetch(apiUrl);
                const files = await response.json();
                const categoryContentDiv = document.getElementById(`${categoryName}-content`);

                files.forEach(file => {
                    if (file.name.endsWith(".md")) { // Only load .md files
                        const fileDiv = document.createElement("div");
                        fileDiv.innerHTML = `<p><a href="#" onclick="loadMarkdown('${file.download_url}', '${file.name}', '${categoryName}')">${file.name}</a></p>`;
                        categoryContentDiv.appendChild(fileDiv);
                    }
                });
            } catch (error) {
                console.error("Error fetching markdown files:", error);
            }
        }

        async function loadMarkdown(fileUrl, fileName, categoryName) {
            try {
                const response = await fetch(fileUrl);
                const markdownText = await response.text();
                const categoryContentDiv = document.getElementById(`${categoryName}-content`);

                let markdownDiv = document.getElementById(`${fileName}-content`);
                if (!markdownDiv) {
                    markdownDiv = document.createElement("div");
                    markdownDiv.id = `${fileName}-content`;
                    markdownDiv.classList.add("markdown-content");
                    markdownDiv.innerHTML = `<h4>${fileName}</h4><div>${marked.parse(markdownText)}</div>`;
                    categoryContentDiv.appendChild(markdownDiv);
                }

                markdownDiv.style.display = markdownDiv.style.display === "none" ? "block" : "none";
            } catch (error) {
                console.error("Error loading markdown file:", error);
            }
        }

        function toggleCategory(categoryName) {
            const categoryContentDiv = document.getElementById(`${categoryName}-content`);
            categoryContentDiv.style.display = categoryContentDiv.style.display === "none" ? "block" : "none";
        }

        fetchCategories();
    </script>

</body>
</html>
